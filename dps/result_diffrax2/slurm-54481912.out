DESC version 0+untagged.6882.g7ed03d7.dirty,using JAX backend, jax version=0.4.19, jaxlib version=0.4.14, dtype=float64
Using device: NVIDIA A100-SXM4-80GB (id=0), with 80.00 GB available memory
*************** START ***************

Starting Equilibrium
Loaded Equilibrium: eq_2411_M1_N1.h5

Using: diffrax

Time from beginning until here: 16.453781127929688s

Building objective: Particle Tracer

Time to build and compile ObjFunction: 0.0026712417602539062s

Building objective: force
Precomputing transforms
Timer: Precomputing transforms = 1.99 sec
Timer: Objective build = 4.65 sec
Timer: Linear constraint projection build = 10.9 sec
Timer: Linear constraint projection build = 359 ms
Compiling objective function and derivatives: ['Particle Tracer']
Timer: Objective compilation time = 9.44 sec
Timer: Gradient compilation time = 2.49 min
Timer: Total compilation time = 2.65 min
Compiling objective function and derivatives: ['force']
Timer: Objective compilation time = 1.60 sec
Timer: Jacobian compilation time = 3.60 sec
Timer: Total compilation time = 5.20 sec
Number of parameters: 13
Number of objectives: 1
Number of equality constraints: 0
Number of inequality constraints: 40
Starting optimization
Using method: fmin-auglag-bfgs
   Iteration     Total nfev        Cost      Cost reduction    Step norm     Optimality    Constr viol.   Penalty param  max(|mltplr|) 
       0              1          6.874e-01                                    2.470e+01      9.990e-02      1.000e+01      0.000e+00   
       1              2          1.070e-01      5.805e-01      1.000e+00      1.118e+00      3.109e-02      1.000e+01      0.000e+00   
       2              3          9.910e-02      7.872e-03      5.059e-03      1.055e+00      3.060e-02      1.000e+01      0.000e+00   
       3              4          6.999e-02      2.911e-02      2.280e-02      7.328e-01      2.828e-02      1.000e+01      0.000e+00   
       4              5          2.925e-02      4.074e-02      6.594e-02      3.077e-01      2.318e-02      1.000e+01      0.000e+00   
       5              6          1.673e-02      1.253e-02      3.370e-02      2.180e-01      2.099e-02      1.000e+01      0.000e+00   
       6              7          7.915e-03      8.810e-03      4.372e-02      1.398e-01      1.860e-02      1.000e+01      0.000e+00   
       7              8          4.867e-03      3.048e-03      2.510e-02      1.044e-01      1.732e-02      1.000e+01      0.000e+00   
       8              9          2.378e-03      2.490e-03      3.270e-02      9.548e-02      1.574e-02      1.000e+01      1.574e-01   
       9             10          3.717e-04      2.006e-03      6.576e-02      6.915e-02      1.282e-02      1.000e+01      1.574e-01   
      10             11          8.375e-05      2.879e-04      3.843e-02      6.042e-02      1.324e-02      1.000e+01      1.574e-01   
      11             12          5.419e-05      2.957e-05      9.583e-03      5.854e-02      1.347e-02      1.000e+01      1.574e-01   
      12             13          2.548e-05      2.870e-05      1.536e-02      5.570e-02      1.383e-02      1.000e+01      1.574e-01   
      13             14          9.224e-07      2.456e-05      4.097e-02      5.275e-02      1.482e-02      1.000e+01      1.574e-01   
      14             15          9.965e-06     -9.042e-06      5.996e-02      5.840e-02      1.641e-02      1.000e+01      1.574e-01   
      15             16          4.545e-04     -4.446e-04      6.253e-02      8.390e-02      1.826e-02      1.000e+01      1.574e-01   
      16             17          3.059e-04      1.486e-04      6.975e-03      7.666e-02      1.784e-02      1.000e+01      1.574e-01   
      17             18          1.097e-04      1.962e-04      1.562e-02      6.311e-02      1.657e-02      1.000e+01      1.574e-01   
      18             19          6.551e-05      4.420e-05      7.378e-03      5.913e-02      1.612e-02      1.000e+01      1.574e-01   
      19             20          1.720e-05      4.832e-05      2.621e-02      4.982e-02      1.464e-02      1.000e+01      1.574e-01   
      20             21          2.419e-07      1.696e-05      5.361e-02      3.809e-02      1.226e-02      1.000e+01      1.574e-01   
      21             22          2.513e-10      2.416e-07      3.276e-02      3.283e-02      1.099e-02      1.000e+01      1.574e-01   
      22             23          7.731e-08     -7.706e-08      1.581e-02      3.052e-02      1.041e-02      1.000e+01      1.574e-01   
Warning: Maximum number of iterations has been exceeded.
         Current function value: 7.731e-08
         Constraint violation: 1.041e-02
         Total delta_x: 1.109e+00
         Iterations: 22
         Function evaluations: 23
         Gradient evaluations: 24
         Hessian evaluations: 0
Timer: Solution time = 43.2 min
Timer: Avg time per step = 1.88 min
Start of solver
Total (sum of squares):  6.874e-01, 
Maximum absolute System solution for initial conditions
Minimum absolute System solution for initial conditions
Average absolute System solution for initial conditions
Maximum absolute System solution for initial conditions(normalized)
Minimum absolute System solution for initial conditions(normalized)
Average absolute System solution for initial conditions(normalized)
Maximum Force error:  9.511e+06 (N)
Minimum Force error: -1.705e+07 (N)
Average Force error: -7.423e+05 (N)
Maximum Force error:  1.184e-02 (normalized)
Minimum Force error: -2.122e-02 (normalized)
Average Force error: -9.237e-04 (normalized)
R boundary error:  0.000e+00 (m)
Z boundary error:  0.000e+00 (m)
Fixed-Psi error:  0.000e+00 (Wb)
Fixed-pressure profile error:  0.000e+00 (Pa)
End of solver
Total (sum of squares):  7.731e-08, 
Maximum absolute System solution for initial conditions
Minimum absolute System solution for initial conditions
Average absolute System solution for initial conditions
Maximum absolute System solution for initial conditions(normalized)
Minimum absolute System solution for initial conditions(normalized)
Average absolute System solution for initial conditions(normalized)
Maximum Force error:  1.550e+06 (N)
Minimum Force error: -1.777e+06 (N)
Average Force error:  3.178e+04 (N)
Maximum Force error:  1.928e-03 (normalized)
Minimum Force error: -2.212e-03 (normalized)
Average Force error:  3.955e-05 (normalized)
R boundary error:  0.000e+00 (m)
Z boundary error:  0.000e+00 (m)
Fixed-Psi error:  0.000e+00 (Wb)
Fixed-pressure profile error:  0.000e+00 (Pa)

Time to optimize: 2803.2916266918182s


Optimization Completed
Optimized Filename: optimized_eq_2411_M1_N1.h5
Total time: 2819.7493600845337s
*********************** OPTIMIZATION END ***********************


*************** TRACING ***************

Time to build and trace (original): 9.022920608520508s

(5000, 4)

Time to build and trace (optimized): 8.756078720092773s

(5000, 4)
(5000, 4)

*********************** TRACING END ***********************


*************** PLOTTING ***************

Original Equilibrium
Trajectory Plot Saved: Trajectory_Plot_original.png
Quantity Plot Saved: Quantity_Plot_original.png
Energy Plot Saved: Energy_Plot_original.png
Optimized Equilibrium
Trajectory Plot Saved: Trajectory_Plot_optimized.png
Quantity Plot Saved: Quantity_Plot_optimized.png
Energy Plot Saved: Energy_Plot_optimized.png
*************** PLOTTING END ***************


Total time: 2855.6476941108704s


*************** END ***************
